<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<title>AngryAnt - Building a menu of delegates and enums - </title>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/css/print.css" type="text/css" media="print" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34029666-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

	</head>
	<body>
		<div id="site">
			<div id="sidebar">
				<h1 class="header">AngryAnt</h1>
<div id="subtitle">Building a menu of delegates and enums</div>

	
		<a href="/">Home</a>
		
	

	
		<a href="/feed">Feed</a>
		
	

	
		<a href="/videos">Videos</a>
		
	

	
		<a href="/contracting">Contracting</a>
		
	

	
		<a href="/path">Path</a>
		
	

	
		<a href="/behave">Behave</a>
		
	


<div id="external">
	<a href="/feed.xml">RSS</a>
	<a href="/feed.articles.xml">Full RSS</a>
	<a href="https://gist.github.com/AngryAnt">Gist</a>
	<a href="https://twitter.com/AngryAnt">Twitter</a>
	<a href="http://www.linkedin.com/in/EmilJohansen">LinkedIn</a>
</div>
<div class="comment">
	That's right - no comments. Contact me on Twitter or otherwise for feedback.
</div>
<img id="logo" title="Logo" alt="Logo" src="/resources/logo.png">

			</div>
			<div id="container">
				<span class="date">15 Mar 2010</span>
				<h1 id="Top">Building a menu of delegates and enums</h1>
				
				<div id="content">
					<p class="post"><p>I like delegates. I also like enums. Furthermore, I happen to be part of a small group of people who actually enjoy the immediate mode <span class="caps">GUI</span> system in Unity. And I want you to like it too :)</p>
<p>So &#8211; menus. After having observed quite a few very funky approaches, in the <a href="http://www.unifycommunity.com/wiki/index.php?title=IRC"><span class="caps">IRC</span></a> channel, to building main menu functionality and giving advice in there, I decided to sow together those ideas into a short example.</p>
<p>The main idea here is to be able to build and manage a menu system quickly and easily. This line adds a new submenu to the system &#8211; designated MyMenuState and implemented in the OnMyMenuGUI method:<br />
<script src='https://gist.github.com/3806175.js?file=NewSubmenu.cs'></script><div><noscript><pre><code>m_Menus [MenuState.MyMenuState] = OnMyMenuGUI;</code></pre></noscript></div></p>
<p>Notice that since we&#8217;re using delegates, the <span class="caps">GUI</span> method needn&#8217;t be implemented in the same script and could even  live on an entirely different GameObject. Why is this so clever (besides enums and delegates being cool)? Because managing and switching between menus set up like this is insanely easy. This is the central <span class="caps">GUI</span> method for the menu system:<br />
<script src='https://gist.github.com/3806175.js?file=OnGUI.cs'></script><div><noscript><pre><code>public void OnGUI ()
{
	m_Menus [m_CurrentState] ();
}</code></pre></noscript></div></p>
<p>And this is <span class="caps">GUI</span> code inside a menu <span class="caps">GUI</span> method for switching to a different submenu:<br />
<script src='https://gist.github.com/3806175.js?file=SwitchMenu.cs'></script><div><noscript><pre><code>m_CurrentState = GUILayout.Button (&amp;quot;Credits&amp;quot;) ? MenuState.Credits : m_CurrentState;</code></pre></noscript></div></p>
<p>So there. Enough talk. Have some example code:<br />
<script src='https://gist.github.com/3806175.js?file=Menu.cs'></script><div><noscript><pre><code>using UnityEngine;
using System.Collections;
using System.Collections.Generic;</p>
<p>public class Menu : MonoBehaviour<br />
{<br />
	delegate void OnGUIImplementation();<br />
	public enum MenuState {Main,Settings,Credits};<br />
	public struct Settings<br />
	{<br />
		public bool m_ThisSetting, m_ThatSetting, m_TheOtherSetting;<br />
	};<br />
	static Vector2 m_StandardMenuSize = new Vector2 (200.0f, 300.0f);<br />
	static string m_LogoURL = &quot;http://download.unity3d.com/images/top-menu/mm_unity_icon.png&quot;;<br />
	static Texture2D m_Logo = null;</p>
<p>private MenuState m_CurrentState = MenuState.Main;<br />
	private Dictionary m_Menus;<br />
	private Settings m_Settings;</p>
<p>void Awake ()<br />
	{<br />
		m_Menus = new Dictionary ();<br />
		m_Menus [MenuState.Main] = OnMainMenuGUI;<br />
		m_Menus [MenuState.Settings] = OnSettingsGUI;<br />
		m_Menus [MenuState.Credits] = OnCreditsGUI;<br />
		StartCoroutine (GetLogo ());<br />
	}</p>
<p>IEnumerator GetLogo ()<br />
	{<br />
		<span class="caps">WWW</span> www = new <span class="caps">WWW</span> (m_LogoURL);</p>
<p>yield return www;</p>
<p>if (www.error == null)<br />
		{<br />
			m_Logo = www.texture;<br />
		}<br />
	}</p>
<p>public void OnGUI ()<br />
	{<br />
		m_Menus [m_CurrentState] ();<br />
	}</p>
<p>static void BeginStandardMenu (string title)<br />
	{<br />
		GUILayout.BeginArea (new Rect ((Screen.width &#8211; m_StandardMenuSize.x) * 0.5f, (Screen.height &#8211; m_StandardMenuSize.y) * 0.5f, m_StandardMenuSize.x, m_StandardMenuSize.y));<br />
			GUILayout.BeginVertical (<span class="caps">GUI</span>.skin.GetStyle (&quot;Box&quot;));<br />
				GUILayout.Label (title, <span class="caps">GUI</span>.skin.GetStyle (&quot;Box&quot;));<br />
	}</p>
<p>static void EndStandardMenu ()<br />
	{<br />
		Color color;</p>
<p>GUILayout.BeginHorizontal ();<br />
					GUILayout.FlexibleSpace ();<br />
						color = <span class="caps">GUI</span>.color;<br />
						<span class="caps">GUI</span>.color = Color.grey;<br />
						GUILayout.Label (&quot;My game version 2.4X&quot;);<br />
						<span class="caps">GUI</span>.color = color;<br />
					GUILayout.FlexibleSpace ();<br />
				GUILayout.EndHorizontal ();<br />
			GUILayout.EndVertical ();<br />
		GUILayout.EndArea ();<br />
	}</p>
<p>void OnMainMenuGUI ()<br />
	{<br />
		BeginStandardMenu (&quot;Main menu&quot;);<br />
			if (m_Logo != null)<br />
			{<br />
				GUILayout.BeginHorizontal ();<br />
					GUILayout.FlexibleSpace ();<br />
						GUILayout.Label (m_Logo);<br />
					GUILayout.FlexibleSpace ();<br />
				GUILayout.EndHorizontal ();<br />
			}<br />
			if (GUILayout.Button (&quot;New game&quot;))<br />
			{<br />
				Application.LoadLevel (&quot;Level one&quot;);<br />
			}<br />
			m_CurrentState = GUILayout.Button (&quot;Settings&quot;) ? MenuState.Settings : m_CurrentState;<br />
			m_CurrentState = GUILayout.Button (&quot;Credits&quot;) ? MenuState.Credits : m_CurrentState;<br />
			GUILayout.FlexibleSpace ();<br />
		EndStandardMenu ();<br />
	}</p>
<p>void OnSettingsGUI ()<br />
	{<br />
		BeginStandardMenu (&quot;Settings&quot;);<br />
			m_Settings.m_ThisSetting = GUILayout.Toggle (m_Settings.m_ThisSetting, &quot;This setting&quot;);<br />
			m_Settings.m_ThatSetting = GUILayout.Toggle (m_Settings.m_ThatSetting, &quot;That setting&quot;);<br />
			m_Settings.m_TheOtherSetting = GUILayout.Toggle (m_Settings.m_TheOtherSetting, &quot;The other setting&quot;, <span class="caps">GUI</span>.skin.GetStyle (&quot;Button&quot;));<br />
			GUILayout.FlexibleSpace ();<br />
			m_CurrentState = GUILayout.Button (&quot;Main menu&quot;) ? MenuState.Main : m_CurrentState;<br />
		EndStandardMenu ();<br />
	}</p>
<p>void OnCreditsGUI ()<br />
	{<br />
		BeginStandardMenu (&quot;Credits&quot;);<br />
			GUILayout.Label (&quot;This game was created by some of the most awesomestest people on the planet. Having failed in their mission to Pluto, they started making games, which &#8211; as you can see &#8211; resulted in much joy and success!&quot;);<br />
				GUILayout.Space (20.0f);<br />
				GUILayout.BeginHorizontal ();<br />
					GUILayout.FlexibleSpace ();<br />
						GUILayout.Label (&quot;The awesomestest people inc.&quot;);<br />
				GUILayout.EndHorizontal ();</p>
<p>GUILayout.FlexibleSpace ();<br />
			m_CurrentState = GUILayout.Button (&quot;Main menu&quot;) ? MenuState.Main : m_CurrentState;<br />
		EndStandardMenu ();<br />
	}<br />
}</code></pre></noscript></div></p>
<p>Example project: <a href="http://eej.dk/angryant/wp-content/uploads/2010/03/Menu.zip">Menu.zip</a> &#8211; built with Unity 2.6.1</p></p>
					<p>&nbsp;</p>

					<div id="feed">
						<div id="newer">
							
								
									
										<h1>Newer posts:</h1>
										<p style="max-height: 1pt">&nbsp;</p>
									
									<a href="/2013/05/14/Five-years-of-Unity-expertise-looking-for-contracts/" class="titleSmall">Five years of Unity expertise looking for contracts</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/12/22/Automagic-Unity-Android-Java-gadget-OF-DOOM/" class="titleSmall">Automagic Unity Android Java gadget OF DOOM!</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/10/03/Invading-Planet-from-your-couch/" class="titleSmall">Invading Planet from your couch</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/09/28/Mountain-Lion-and-laggy-bluetooth-and-duct-tape/" class="titleSmall">Mountain Lion and laggy bluetooth and duct-tape</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/09/23/Unite-12-video-and-new-videos-section-available/" class="titleSmall">Unite 12 video and new videos section available</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/08/28/Asia-Bootcamp-videos-now-available/" class="titleSmall">Asia Bootcamp videos now available</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2012/05/17/path-is-now-mit-licensed/" class="titleSmall">Path is now MIT licensed</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/11/30/behave-1-4-released/" class="titleSmall">Behave 1.4 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/10/09/so-ive-been-a-bit-busy-lately/" class="titleSmall">So I've been a bit busy lately</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/04/28/behave-1-3-released/" class="titleSmall">Behave 1.3 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/04/23/igda-unity-sig-slides/" class="titleSmall">IGDA Unity SIG slides</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/03/17/second-unity-igda-sig-this-evening-scene-construction-and-ai/" class="titleSmall">Second Unity IGDA SIG this evening: Scene construction and AI</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/03/10/first-igda-unity-sig-this-evening/" class="titleSmall">First IGDA Unity SIG this evening</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/03/03/alternative-licensing-available/" class="titleSmall">Alternative licensing available</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/02/15/pathfinding-in-two-line/" class="titleSmall">Pathfinding in two lines</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/02/15/path-2-released/" class="titleSmall">Path 2 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/02/02/assembling-and-assimilating/" class="titleSmall">Assembling and assimilating</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/01/29/path-2-intro-screencast/" class="titleSmall">Path 2 intro screencast</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/01/29/path-2-beta-release-for-ggj/" class="titleSmall">Path 2 beta release for GGJ</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/01/25/aigamedev-master-class-video-now-online-3/" class="titleSmall">AIgameDev master class video now online</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2011/01/09/expanding-beta/" class="titleSmall">Expanding beta</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/11/28/behave-aigamedev-master-class-public-stream/" class="titleSmall">Behave AIgameDev master class public stream</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/11/27/behave-master-class-on-open-aigamedev-stream-tomorrow/" class="titleSmall">Behave master class on open AIgameDev stream tomorrow</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/29/interview-with-aigamedev/" class="titleSmall">Interview with AIGameDev</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/24/new-video-from-tree-to-code/" class="titleSmall">New video: From tree to code</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/23/issue-tracking-on-github-behave-release-project/" class="titleSmall">Issue tracking on github Behave release project</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/22/it-university-copenhagen-unity-course-completed/" class="titleSmall">IT University Copenhagen Unity course completed</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/21/it-university-copenhagen-unity-course-files-thursday/" class="titleSmall">IT University Copenhagen Unity course files Thursday</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/20/cph-it-university-unity-course-files/" class="titleSmall">CPH IT University Unity course files</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/10/11/behave-1-2-released/" class="titleSmall">Behave 1.2 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/09/29/video-behave-starting-from-scratch/" class="titleSmall">Video: Behave - starting from scratch</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/09/29/behave-runtime-documentation-updated/" class="titleSmall">Behave runtime documentation updated</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/09/29/behave-1-1-released/" class="titleSmall">Behave 1.1 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/03/19/faff-cleanup-sketch/" class="titleSmall">FAFF cleanup: Sketch</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									</div>
									<div id="older">
										<h1>Older posts:</h1>
										<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/03/10/pick-me-pick-me/" class="titleSmall">Pick me! Pick me!</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/01/14/optimising-coroutine-yielding-in-c/" class="titleSmall">Optimising coroutine yielding in C#</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2010/01/05/downloading-the-hydra/" class="titleSmall">Downloading the hydra</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/11/15/new-license-of-path-gpl/" class="titleSmall">New license of Path: GPL</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/11/04/copyinspector/" class="titleSmall">CopyInspector</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/10/04/magnetic/" class="titleSmall">Magnetic</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/09/18/gui-drag-drop/" class="titleSmall">GUI drag-drop</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/09/17/logging-an-entire-gameobject/" class="titleSmall">Logging an entire GameObject</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/09/07/i-bet-you-cant-type-an-a/" class="titleSmall">I bet you can't type an A!</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/08/31/where-did-that-component-go/" class="titleSmall">Where did that component go?</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/08/19/unitysteer/" class="titleSmall">UnitySteer</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/05/18/new-and-improved-behave-10-released/" class="titleSmall">New and improved: Behave 1.0 released</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/04/08/behave-03b-and-unity-25/" class="titleSmall">Behave 0.3b and unity 2.5</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/03/20/behave-03b-hotfix/" class="titleSmall">Behave 0.3b hotfix</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/03/19/path-tutorial-video-available/" class="titleSmall">Path tutorial video available</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2009/03/18/path-10-launched/" class="titleSmall">Path 1.0 launched!</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/12/17/community-tutorial-2/" class="titleSmall">Continued community tutorials</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/11/30/community-tutorial/" class="titleSmall">Community tutorial</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/11/28/new-tutorial/" class="titleSmall">New tutorial</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/11/04/first-tutorial-available/" class="titleSmall">First tutorial available</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/11/02/behave-03b/" class="titleSmall">Behave 0.3b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/10/25/unite-08-open-mic-session/" class="titleSmall">unite '08 open-mic session</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/09/24/behave-02b/" class="titleSmall">Behave 0.2b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/09/09/behave-01b/" class="titleSmall">Behave 0.1b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/09/08/behave-pre-release/" class="titleSmall">Behave pre-release</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/04/15/path-beta-03b/" class="titleSmall">Path beta 0.3b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/04/12/path-beta-02b/" class="titleSmall">Path beta 0.2b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/04/05/path-beta-01b/" class="titleSmall">Path beta 0.1b</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
								
									
									<a href="/2008/03/30/path-pre-release/" class="titleSmall">Path pre-release</a>
									<p style="max-height: 1pt">&nbsp;</p>
								
							
						</div>
					</div>
				</div>
				<p class="footnote" style="margin-top: 50px; margin-bottom: 10px; clear: both;">Copyright &#169; Emil Johansen &amp; AngryAnt <script>document.write ((new Date ()).getFullYear ());</script> - all public gists are public domain</p>
<script>document.write ('<img src="/resources/footers/' + Math.floor (Math.random () * 22 + 1) + '.png" width="600" height="300" class="noprint" style="margin-bottom: -5px;">');</script>

			</div>
		</div>
		

	</body>
</html>
